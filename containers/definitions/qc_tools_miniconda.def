Bootstrap: docker
From: continuumio/miniconda3:latest

# To build this container image, use the command below:

# sudo singularity build qc_tools_miniconda.sif qc_tools_miniconda.def

%post
# Update packages and install core dependencies with apt-get
apt-get update
apt-get install -y --no-install-recommends wget git bzip2 tar unzip

# Install bioinformatics tools with Conda
conda install -n base -c bioconda -c conda-forge -y openjdk=17 \
bbmap nanoplot nanoQC fastqc quast chopper

# cleanup cache
apt-get clean
conda clean -afy
rm -rf /var/lib/apt/lists/*

%environment
# Add all tool directories to the PATH
export CONDA_ENV="qc_env"
export PATH="/opt/conda/envs/$CONDA_ENV/bin:/opt/conda/bin:$PATH"
export JAVA_HOME="/usr/lib/jvm/java-17-openjdk-amd64" # May be needed for BBMap if manually installed

%runscript
echo "This container includes BBTools, NanoPlot, FastQC, and MetaQUAST."
echo "To run a specific tool, specify it as an argument, e.g.:"
echo "singularity exec qc_tools.sif stats.sh"
echo "singularity exec qc_tools.sif fastqc"
echo "singularity exec qc_tools.sif nanoplot"
echo "singularity exec qc_tools.sif metaquast"
exec "$@"

%labels
Maintainer lowry-nitrogen-team
CreationDate 2025-09-30
Version 1.1-conda
Description Singularity container with QC tools: BBTools, NanoPlot, FastQC, and MetaQUAST.

%help
This Singularity container provides a ready-to-use environment for
several common genomics analysis tools for quality control:
\- BBTools (BBDuk, Stats.sh, etc.)
\- NanoPlot (for ONT read QC)
\- FastQC (for Illumina read QC)
\- MetaQUAST (for assembly quality metrics)

To use a tool, execute the container and specify the tool's command:
singularity exec qc_tools.sif <tool_name> <options>

For example:
singularity exec qc_tools.sif stats.sh --help
singularity exec qc_tools.sif nanoplot --help
singularity exec qc_tools.sif fastqc --help
singularity exec qc_tools.sif metaquast --help
